---
title: "Tree Species Index"
author: '-------------------------------------'
date: "4/20/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

We will propose a simple system for indexing the different species of trees, based on whether a tree is native, large, or evergreen, using the following formula:

$I = S + N + E$

The variable $S$, based on size, takes a value of 1/3/5 for small/medium/large trees.  The variable $N$ refers to whether or not a tree is native, taking a value of 1 for native trees and 0 for all other trees.  Finally, $E$ takes a value of 2 for evergreen trees, and 0 for all other trees.  A tree will have an index value from 1 (worst) to 8 (best).

```{r,cache=T}
# load up tidy dataset
trees <- read.csv("~/emergency-response-time/data/tree_tidy.csv")
```

```{r}
# get rid of cols we don't need
index_build <- trees %>%
  select(species, funct, size, native)
# mutate a whole bunch of numeric variables
index_build <- trees %>%
  mutate(s = ifelse(size=="S", 1,
                    ifelse(size=="M", 3, 5))) %>%
  mutate(n = ifelse(native, 1, 0)) %>%
  mutate(e = ifelse(funct %in% c("BE","CE"),2, 0)) %>%
  # mutate index
  mutate(index = s + n + e)

# make a simple index of all the species
tree_index <- index_build %>%
  select(species,index) %>%
  group_by(species) %>%
  summarize(index=mean(index))

# full join index and tidy set
tree_tidy_index <- trees %>%
  full_join(tree_index,by=c("species"="species"))
str(tree_tidy_index)
```

```{r}
# export new tidy, tree index

setwd("~/emergency-response-time/data")
write.csv(tree_tidy_index, "tree_tidy_index.csv",row.names=F)
write.csv(tree_index, "tree_index.csv",row.names=F)
```








